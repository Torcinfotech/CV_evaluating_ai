<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI-Powered CV Screening Platform</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>

 <style>
  :root {
    /* ===== EIM Brand Palette (baked in) ===== */
    --eim-navy: #0F2A36;
    --eim-navy-800: #123442;
    --eim-slate: #6F8596;
    --eim-slate-600: #5E7383;
    --eim-slate-300: #9AAAB6;
    --eim-slate-100: #E6ECF0;

    /* Map to your design tokens */
    --primary-50: #f4f7f9;
    --primary-100: #eaf0f4;
    --primary-500: var(--eim-navy);
    --primary-600: var(--eim-navy-800);
    --primary-700: #0c2230;
    --primary-900: #091922;

    --secondary-50: #f7f9fb;
    --secondary-100: var(--eim-slate-100);
    --secondary-200: #dfe6ea;
    --secondary-300: #cfd8de;
    --secondary-500: var(--eim-slate);
    --secondary-600: var(--eim-slate-600);
    --secondary-700: #3f5463;
    --secondary-900: #14212a;

    --accent-50: #eaf1f4;
    --accent-500: #274A56;

    --success-50: #f3fbf7;
    --success-200: #d8f0e4;
    --success-500: #1E9B68;
    --success-600: #157954;

    --error-50: #fef2f2;
    --error-200: #f8d6d6;
    --error-500: #D94A4A;
    --error-600: #B83C3C;

    --warning-50: #fffbeb;
    --warning-500: #f59e0b;

    /* Gradients tuned to EIM */
    --gradient-primary: linear-gradient(135deg, #163543 0%, #6F8596 100%);
    --gradient-secondary: linear-gradient(135deg, #274A56 0%, #6F8596 100%);
    --gradient-success: linear-gradient(135deg, #0F2A36 0%, #274A56 100%);
    --gradient-surface: linear-gradient(135deg, #0F2A36 0%, #274A56 100%);

    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);

    /* Spacing */
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.25rem;
    --space-6: 1.5rem;
    --space-8: 2rem;
    --space-10: 2.5rem;
    --space-12: 3rem;
    --space-16: 4rem;
    --space-20: 5rem;

    /* Radii */
    --radius-sm: 0.375rem;
    --radius-md: 0.5rem;
    --radius-lg: 0.75rem;
    --radius-xl: 1rem;
    --radius-2xl: 1.5rem;
    --radius-full: 9999px;

    /* Typography */
    --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    --text-xs: 0.75rem;
    --text-sm: 0.875rem;
    --text-base: 1rem;
    --text-lg: 1.125rem;
    --text-xl: 1.25rem;
    --text-2xl: 1.5rem;
    --text-3xl: 1.875rem;
    --text-4xl: 2.25rem;
    --text-5xl: 3rem;

    /* Transitions */
    --transition-fast: 150ms ease-in-out;
    --transition-normal: 300ms ease-in-out;
    --transition-slow: 500ms ease-in-out;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: var(--font-family);
    background: #ffffff;
    color: var(--secondary-900);
    min-height: 100vh;
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Header */
  .header {
    background: #ffffff;
    border-bottom: 1px solid var(--secondary-100);
    padding: var(--space-6) 0;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.06);
  }
  .header-content, .header-inner {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--space-6);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .logo {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    font-size: var(--text-xl);
    font-weight: 700;
    color: var(--primary-600);
  }
  .logo-icon {
    width: 100px;
    height: 50px;
    background: var(--gradient-primary);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    overflow: hidden;
  }

  /* Buttons */
  .btn {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-6);
    border: none;
    border-radius: var(--radius-lg);
    font-weight: 600;
    font-size: var(--text-sm);
    cursor: pointer;
    transition: all var(--transition-fast);
    text-decoration: none;
  }
  .btn-primary {
    background: var(--gradient-primary);
    color: white;
    box-shadow: var(--shadow-md);
  }
  .btn-primary:hover { transform: translateY(-2px); box-shadow: var(--shadow-lg); }
  .btn-secondary, .btn-ghost {
    background: #fff;
    color: var(--secondary-700);
    border: 1px solid var(--secondary-100);
  }
  .btn-secondary:hover, .btn-ghost:hover {
    background: var(--secondary-50);
    transform: translateY(-1px);
  }

  /* Container / Hero */
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: var(--space-8) var(--space-6);
  }
  .hero { text-align: center; margin-bottom: var(--space-16); }
  .hero-title, .hero h1 {
    font-size: var(--text-5xl);
    font-weight: 700;
    color: var(--secondary-900);
    margin-bottom: var(--space-4);
    line-height: 1.2;
  }
  .hero-subtitle, .hero p {
    font-size: var(--text-xl);
    color: var(--secondary-600);
    margin-bottom: var(--space-8);
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  /* Grid */
  .main-content { display: grid; grid-template-columns: 1fr; gap: var(--space-8); }
  @media (min-width: 1024px) {
    .main-content { grid-template-columns: 1fr 2fr; align-items: start; }
  }

  /* Upload Section */
  .upload-section, #sectionUpload .card {
    background: #ffffff;
    border-radius: var(--radius-2xl);
    padding: var(--space-12);
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--secondary-100);
    position: relative;
    overflow: hidden;
    max-width: 980px;
    margin: 0 auto;
  }
  .upload-section::before, .card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--eim-navy), var(--eim-slate));
  }
  .upload-label, .drop {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    gap: var(--space-6);
    padding: var(--space-16) var(--space-8);
    border: 2px dashed var(--secondary-300);
    border-radius: var(--radius-xl);
    background: #fbfdff;
    cursor: pointer;
    transition: all var(--transition-normal);
    min-height: 220px;
  }
  .upload-label:hover, .drop:hover {
    border-color: var(--eim-slate);
    background: #f3f7fa;
    transform: translateY(-2px);
    box-shadow: var(--shadow-xl);
  }
  .upload-label.dragover, .drop.dragover { border-color: var(--primary-500); background: #eef5f9; transform: scale(1.02); }
  .upload-label input, .drop input { display: none; }

  .upload-icon {
    width: 80px; height: 80px; border-radius: var(--radius-full);
    background: var(--gradient-primary);
    display: flex; align-items: center; justify-content: center;
    color: white; font-size: var(--text-3xl);
    box-shadow: 0 10px 15px -3px rgb(22 53 67 / 0.25);
    transition: all var(--transition-normal);
  }
  .upload-label:hover .upload-icon, .drop:hover .upload-icon {
    transform: scale(1.1);
    box-shadow: 0 20px 25px -5px rgb(22 53 67 / 0.35);
  }
  .upload-text { font-size: var(--text-xl); font-weight: 700; color: var(--secondary-900); text-align: center; }
  .upload-hint, .muted { font-size: var(--text-sm); color: var(--secondary-600); text-align: center; }
  .upload-features, .features { display: flex; gap: var(--space-8); margin-top: var(--space-6); justify-content: center; flex-wrap: wrap; }
  .upload-feature { display: flex; align-items: center; gap: var(--space-2); font-size: var(--text-sm); color: var(--secondary-600); }

  .cv-preview {
    display: none;
    background: #ffffff;
    border-radius: var(--radius-xl);
    padding: var(--space-6);
    margin-top: var(--space-6);
    box-shadow: var(--shadow-md);
    border: 1px solid var(--secondary-100);
    max-width: 980px;
    margin-left: auto; margin-right: auto;
  }
  .cv-preview.show { display: block; animation: slideUp 0.5s ease-out; }
  @keyframes slideUp { from { opacity: 0; transform: translateY(20px);} to { opacity: 1; transform: translateY(0);} }

  .start-wrap { text-align: center; margin-top: var(--space-6); }
  .start-analysis-btn, .start-btn {
    background: linear-gradient(135deg, #1b4b5e, #0F2A36);
    color: white; border: none; border-radius: var(--radius-lg);
    padding: var(--space-4) var(--space-8); font-size: var(--text-lg);
    font-weight: 700; cursor: pointer; transition: all var(--transition-normal);
    display: inline-flex; align-items: center; gap: var(--space-3);
    box-shadow: 0 10px 15px -3px rgb(15 42 54 / 0.30);
  }
  .start-analysis-btn:hover, .start-btn:hover { transform: translateY(-2px); box-shadow: 0 20px 25px -5px rgb(15 42 54 / 0.42); }

  /* PDF VIEWERS */
  .pdf-viewer {
    margin-top: var(--space-6);
    border: 1px solid var(--secondary-100);
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-md);
    background: #fff;
  }
  .pdf-viewer header {
    background: var(--secondary-50);
    color: var(--secondary-700);
    padding: var(--space-3) var(--space-4);
    font-weight: 600;
    border-bottom: 1px solid var(--secondary-100);
  }
  .pdf-viewer iframe {
    width: 100%;
    height: 520px; /* home viewer height */
    border: 0;
    display: block;
  }

  /* Wizard container & PDF side panel */
  .wizard, .wizard-container {
    max-width: 1200px; margin: 0 auto;
    background: #ffffff; border-radius: var(--radius-2xl);
    box-shadow: var(--shadow-lg); border: 1px solid var(--secondary-100);
    overflow: hidden; position: relative;
  }
  .wiz-head {
    background: var(--gradient-surface); color: white;
    padding: var(--space-8); text-align: center;
  }
  .wiz-body {
    padding: var(--space-8);
  }
  /* Two-column layout: PDF (left) + Step content (right) */
  .wiz-grid {
    display: grid;
    grid-template-columns: 1.2fr 1.8fr;
    gap: var(--space-6);
    align-items: start;
  }
  .pdf-panel {
    position: sticky;
    top: 84px; /* keep below header */
    background: #fff;
    border: 1px solid var(--secondary-100);
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
  }
  .pdf-panel header {
    background: var(--secondary-50);
    padding: var(--space-3) var(--space-4);
    font-weight: 600;
    color: var(--secondary-700);
    border-bottom: 1px solid var(--secondary-100);
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .pdf-panel iframe {
    width: 100%;
    height: 70vh; /* taller in wizard */
    border: 0;
    display: block;
    background: #fff;
  }
  @media (max-width: 1024px) {
    .wiz-grid { grid-template-columns: 1fr; }
    .pdf-panel { position: relative; top: 0; }
    .pdf-panel iframe { height: 420px; }
  }

  .quit, .quit-btn {
    position: absolute; top: var(--space-4); right: var(--space-4);
    background: #ffffff; color: rgb(0, 0, 0); border: none; border-radius: var(--radius-full);
    width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;
    cursor: pointer; transition: all var(--transition-fast); z-index: 10;
  }
  .quit:hover, .quit-btn:hover { background: #dc2626; color: #fff; transform: scale(1.06); }

  .wizard-title { font-size: var(--text-2xl); font-weight: 700; margin-bottom: var(--space-2); }
  .wizard-subtitle { font-size: var(--text-base); opacity: 0.9; }

  .prog {
    display: flex; justify-content: center; align-items: center; gap: var(--space-4); margin-top: var(--space-6);
    flex-wrap: wrap;
  }
  .pill {
    display: flex; align-items: center; gap: var(--space-2);
    padding: var(--space-3) var(--space-4);
    background: rgba(255, 255, 255, 0.18);
    border-radius: var(--radius-full);
    font-size: var(--text-sm); font-weight: 600;
    transition: all var(--transition-fast);
  }
  .pill.active { background: rgba(255, 255, 255, 0.28); transform: scale(1.03); }
  .pill.done { background: #fff; color: var(--eim-navy); }

  .wizard-step, .step { display: none; animation: fadeIn 0.5s ease-in-out; }
  .wizard-step.active, .step.active { display: block; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(20px);} to { opacity: 1; transform: translateY(0);} }

  .dots { display: flex; justify-content: center; gap: var(--space-2); margin-bottom: var(--space-6); }
  .dot { width: 12px; height: 12px; border-radius: 50%; background: var(--secondary-100); transition: all var(--transition-fast); }
  .dot.active { background: var(--eim-navy); transform: scale(1.2); }
  .dot.done { background: #1E9B68; }

  .wiz-nav {
    display: flex; justify-content: space-between; align-items: center;
    padding: var(--space-6) var(--space-8);
    background: #f9fafb; border-top: 1px solid var(--secondary-100);
  }
  .wiz-btn {
    display: inline-flex; align-items: center; gap: var(--space-2);
    padding: var(--space-3) var(--space-6); border: none; border-radius: var(--radius-lg);
    font-weight: 700; font-size: var(--text-sm); cursor: pointer; transition: all var(--transition-fast);
  }
  .wiz-btn:disabled { opacity: 0.5; cursor: not-allowed; }
  .wiz-btn.primary {
    background: var(--gradient-primary); color: white; box-shadow: 0 4px 6px -1px rgb(15 42 54 / 0.30);
  }
  .wiz-btn.primary:hover:not(:disabled) {
    transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgb(15 42 54 / 0.40);
  }
  .wiz-btn.secondary {
    background: #fff; color: var(--secondary-700); border: 1px solid var(--secondary-100);
  }
  .wiz-btn.secondary:hover:not(:disabled) {
    background: var(--secondary-50); border-color: var(--secondary-100);
  }

  /* Cards / criteria (unchanged core) */
  .card {
    background: #ffffff;
    border-radius: var(--radius-2xl);
    padding: var(--space-8);
    box-shadow: var(--shadow-md);
    border: 1px solid var(--secondary-100);
    transition: all var(--transition-normal);
    position: relative;
    overflow: hidden;
  }
  .card:hover { transform: translateY(-4px); box-shadow: var(--shadow-xl); border-color: var(--eim-slate); }
  .card h3 { font-size: var(--text-xl); font-weight: 700; color: var(--primary-600); margin-bottom: var(--space-6); display: flex; gap: 10px; align-items: center; }
  .criteria-list { list-style: none; display: flex; flex-direction: column; gap: var(--space-4); padding: 0; margin: 0; }
  .criteria-item { background: #fbfcfd; border-radius: var(--radius-lg); padding: var(--space-4); border: 1px solid var(--secondary-100); transition: all var(--transition-fast); }
  .criteria-item:hover { background: #f4f7fa; border-color: var(--eim-slate-300); }
  .row { display: flex; align-items: center; justify-content: space-between; gap: var(--space-4); flex-wrap: wrap; }
  .name { flex: 1; font-weight: 600; color: var(--secondary-700); min-width: 200px; }

  .rating {
    padding: var(--space-2) var(--space-3);
    border: 1px solid var(--secondary-300);
    border-radius: var(--radius-md);
    background: white;
    font-size: var(--text-sm);
    color: var(--secondary-700);
    transition: all var(--transition-fast);
  }
  .rating:focus, .reason textarea:focus, .addbar select:focus {
    outline: none; border-color: var(--primary-500); box-shadow: 0 0 0 3px rgba(15, 42, 54, 0.12);
  }

  .acts { display: flex; gap: var(--space-2); align-items: center; }
  .icon-btn {
    width: 36px; height: 36px; border: 1px solid var(--secondary-200); border-radius: var(--radius-md);
    background: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center;
    font-size: var(--text-lg); transition: all var(--transition-fast);
  }
  .icon-btn:hover { background: var(--secondary-100); transform: scale(1.05); }
  .icon-btn.dislike.active { background: #f4eaea; color: var(--error-600); border-color: var(--error-600); }
  .icon-btn.delete:hover { background: #f9ebeb; color: var(--error-600); }

  .reason { margin-top: var(--space-4); display: none; animation: slideDown 0.3s ease-out; }
  .reason.show { display: block; }
  @keyframes slideDown { from { opacity:0; transform: translateY(-10px);} to { opacity:1; transform: translateY(0);} }
  .reason textarea {
    width: 100%; padding: var(--space-3); border: 1px solid var(--secondary-300);
    border-radius: var(--radius-md); font-family: inherit; font-size: var(--text-sm); resize: vertical; min-height: 80px;
    transition: all var(--transition-fast);
  }

  .addbar {
    margin-top: var(--space-6); padding-top: var(--space-6); border-top: 1px solid var(--secondary-200);
    display: flex; gap: var(--space-3); align-items: center;
  }
  .addbar select {
    flex: 1; padding: var(--space-3); border: 1px solid var(--secondary-300); border-radius: var(--radius-md);
    background: white; font-size: var(--text-sm); color: var(--secondary-700); transition: all var(--transition-fast);
  }
  .add-btn {
    padding: var(--space-3) var(--space-6); background: var(--gradient-primary); color: white; border: none; border-radius: var(--radius-md);
    font-weight: 600; font-size: var(--text-sm); cursor: pointer; transition: all var(--transition-fast);
    display: inline-flex; align-items: center; gap: var(--space-2); box-shadow: 0 6px 14px -6px rgb(15 42 54 / 0.35);
  }
  .add-btn:hover { transform: translateY(-2px); box-shadow: 0 14px 22px -10px rgb(15 42 54 / 0.45); }

  /* Loading & toast */
  .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.35); border-radius: 50%; border-top-color: white; animation: spin 1s linear infinite; }
  .loading-spinner { width: 48px; height: 48px; border: 4px solid #e5e7eb; border-top: 4px solid var(--primary-500); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto var(--space-4); }
  @keyframes spin { to { transform: rotate(360deg); } }
  .toast {
    position: fixed; bottom: 18px; left: 50%; transform: translateX(-50%);
    background: #111827; color: #fff; padding: 10px 14px;
    border-radius: 10px; box-shadow: var(--shadow-lg); opacity: .98; z-index: 9999;
  }

  /* Completion */
  .done {
    max-width: 720px; margin: 0 auto; background: #ffffff; border: 1px solid var(--secondary-100);
    border-radius: var(--radius-2xl); box-shadow: var(--shadow-lg); text-align: center; overflow: hidden;
  }
  .done-body { padding: var(--space-12); }
  .tick {
    width: 80px; height: 80px; background: linear-gradient(135deg, #10b981, #059669);
    border-radius: var(--radius-full);
    display: flex; align-items: center; justify-content: center; color: white; font-size: var(--text-4xl);
    margin: 0 auto var(--space-6);
    animation: bounceIn 0.6s ease-out;
  }
  @keyframes bounceIn { 0%{ transform: scale(0.3); opacity: 0;} 50%{ transform: scale(1.05);} 70%{ transform: scale(0.9);} 100%{ transform: scale(1); opacity: 1;} }
  .upload-new { background: var(--gradient-primary); color: white; border: none; border-radius: var(--radius-lg); padding: var(--space-4) var(--space-8); font-size: var(--text-lg); font-weight: 700; cursor: pointer; transition: all var(--transition-normal); display: inline-flex; align-items: center; gap: var(--space-3); box-shadow: 0 10px 15px -3px rgb(15 42 54 / 0.30); }
  .upload-new:hover { transform: translateY(-2px); box-shadow: 0 20px 25px -5px rgb(15 42 54 / 0.42); }

  /* Utilities */
  .hidden { display: none !important; }
</style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-inner">
      <div class="logo">
        <div class="logo-icon">
            <img src="./logo.webp" width="100" alt="Logo">
        </div>
        <span>AI Screening Platform</span>
      </div>
      <div>
        <button class="btn btn-ghost"><i class="fa-solid fa-download"></i>&nbsp;Export</button>
        <button class="btn btn-primary"><i class="fa-solid fa-gear"></i>&nbsp;Settings</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="hero">
      <h1>AI-Powered CV Screening</h1>
      <p>Upload a CV and walk through a clean, step-by-step analysis. Quit anytime or start over with a new upload.</p>
    </div>

    <!-- =================== HOME / UPLOAD =================== -->
    <section id="sectionUpload">
      <div class="card">
        <label class="drop" for="fileInput" id="dropLabel">
          <div class="upload-icon"><i class="fa-solid fa-cloud-arrow-up"></i></div>
          <div style="font-weight:700">Drop your CV here or click to browse</div>
          <div class="muted">PDF, DOC or DOCX • up to 10MB</div>
          <div class="features">
            <span><i class="fa-solid fa-shield-halved" style="color:#10b981"></i> Secure</span>
            <span><i class="fa-solid fa-bolt" style="color:#10b981"></i> Fast</span>
            <span><i class="fa-solid fa-lock" style="color:#10b981"></i> Private</span>
          </div>
          <input type="file" id="fileInput" accept=".pdf,.doc,.docx">
        </label>

        <div id="uploadSuccess" class="cv-preview" aria-live="polite">
          <div class="status" role="status">
            <i class="fa-solid fa-circle-check" style="color:#16a34a"></i>
            <div>
              <div style="font-weight:700">File uploaded successfully</div>
              <div class="muted">Ready for AI analysis</div>
            </div>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px">
            <span id="fileName" style="font-weight:600"></span>
            <span id="fileMeta" class="muted"></span>
          </div>
        </div>

        <!-- HOME PDF PREVIEW -->
        <div id="pdfViewerHome" class="pdf-viewer hidden" aria-hidden="true">
          <header><i class="fa-solid fa-file-pdf"></i> CV Preview</header>
          <iframe id="pdfFrameHome" title="Uploaded CV Preview (Home)"></iframe>
        </div>

        <div class="start-wrap hidden" id="startWrap">
          <button class="start-btn" id="btnStart"><i class="fa-solid fa-play"></i> Start CV Analysis</button>
        </div>
      </div>
    </section>

    <!-- =================== WIZARD =================== -->
    <section id="wizardContainer" class="wizard hidden" aria-hidden="true">
      <button id="btnQuit" class="quit" title="Quit analysis" aria-label="Quit analysis"><i class="fa-solid fa-xmark"></i></button>
      <div class="wiz-head">
        <h2 class="wizard-title">CV Analysis Wizard</h2>
        <div class="wizard-subtitle">Navigate with Previous / Next. Finish to complete.</div>
        <div class="prog" id="progPills">
          <div class="pill" id="pill1"><i class="fa-solid fa-upload"></i> Upload</div>
          <div class="pill" id="pill2"><i class="fa-solid fa-industry"></i> Industry</div>
          <div class="pill" id="pill3"><i class="fa-solid fa-briefcase"></i> Functions</div>
          <div class="pill" id="pill4"><i class="fa-solid fa-cogs"></i> Competences</div>
          <div class="pill" id="pill5"><i class="fa-solid fa-language"></i> Languages</div>
          <div class="pill" id="pill6"><i class="fa-solid fa-globe"></i> International</div>
          <div class="pill" id="pill7"><i class="fa-solid fa-graduation-cap"></i> Education</div>
        </div>
      </div>

      <div class="wiz-body">
        <!-- PDF side + steps grid -->
        <div class="wiz-grid">
          <!-- LEFT: persistent PDF in wizard -->
          <aside class="pdf-panel" id="pdfPanelWizard">
            <header><i class="fa-solid fa-file-pdf"></i> CV Preview (in steps)</header>
            <iframe id="pdfFrameWizard" title="Uploaded CV Preview (Wizard)"></iframe>
          </aside>

          <!-- RIGHT: steps content -->
          <div>
            <!-- Step 1: Loading -->
            <div class="step active" id="step1">
              <div style="text-align:center;padding:32px 0">
                <div class="loading" style="width:48px;height:48px;border:4px solid #e5e7eb;border-top:4px solid #3b82f6;border-radius:50%;margin:0 auto 10px;animation:spin 1s linear infinite"></div>
                <h3>Analyzing your CV…</h3>
                <p class="muted">Extracting key info and preparing criteria.</p>
              </div>
            </div>

            <!-- Step 2: Industry -->
            <div class="step" id="step2">
              <div class="dots" aria-hidden="true">
                <div class="dot done"></div><div class="dot active"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
              </div>
              <div class="card">
                <h3><i class="fa-solid fa-industry"></i> Industry Knowledge</h3>
                <ul class="criteria-list" id="industryList">
                  <li class="criteria-item">
                    <div class="row">
                      <div class="name">N10 – Business economy (B2B services)</div>
                      <select class="rating" title="Rate 1 (bad) to 5 (good)">
                        <option value="">Rate…</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
                      </select>
                      <div class="acts">
                        <button class="icon-btn dislike" title="Dislike"><i class="fa-solid fa-thumbs-down"></i></button>
                        <button class="icon-btn delete" title="Delete"><i class="fa-solid fa-trash"></i></button>
                      </div>
                    </div>
                    <div class="reason"><textarea placeholder="Why is this not suitable?"></textarea></div>
                  </li>
                </ul>
                <div class="addbar">
                  <select id="industrySelect">
                    <option value="">Add new industry…</option>
                    <option>N20 – Renewable Energy</option>
                    <option>G15 – Software Development</option>
                  </select>
                  <button class="btn btn-primary add-btn" data-target="industryList"><i class="fa-solid fa-plus"></i> Add</button>
                </div>
              </div>
            </div>

            <!-- Step 3: Functions -->
            <div class="step" id="step3">
              <div class="dots"><div class="dot done"></div><div class="dot done"></div><div class="dot active"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
              <div class="card">
                <h3><i class="fa-solid fa-briefcase"></i> Job Functions</h3>
                <ul class="criteria-list" id="functionsList">
                  <li class="criteria-item">
                    <div class="row">
                      <div class="name">110 CEO</div>
                      <select class="rating"><option value="">Rate…</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
                      <div class="acts">
                        <button class="icon-btn dislike"><i class="fa-solid fa-thumbs-down"></i></button>
                        <button class="icon-btn delete"><i class="fa-solid fa-trash"></i></button>
                      </div>
                    </div>
                    <div class="reason"><textarea placeholder="Why is this not suitable?"></textarea></div>
                  </li>
                </ul>
                <div class="addbar">
                  <select id="functionsSelect">
                    <option value="">Add new function…</option>
                    <option>220 Chief Technology Officer</option>
                    <option>330 Marketing Director</option>
                  </select>
                  <button class="btn btn-primary add-btn" data-target="functionsList"><i class="fa-solid fa-plus"></i> Add</button>
                </div>
              </div>
            </div>

            <!-- Step 4: Competences -->
            <div class="step" id="step4">
              <div class="dots"><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
              <div class="card">
                <h3><i class="fa-solid fa-cogs"></i> Key Competences</h3>
                <ul class="criteria-list" id="competencesList">
                  <li class="criteria-item">
                    <div class="row">
                      <div class="name">0120 – Top line growth</div>
                      <div class="acts">
                        <button class="icon-btn dislike"><i class="fa-solid fa-thumbs-down"></i></button>
                        <button class="icon-btn delete"><i class="fa-solid fa-trash"></i></button>
                      </div>
                    </div>
                    <div class="reason"><textarea placeholder="Why is this not suitable?"></textarea></div>
                  </li>
                </ul>
                <div class="addbar">
                  <select id="competencesSelect">
                    <option value="">Add new competence…</option>
                    <option>0450 – Automation & Robotics</option>
                    <option>0850 – Risk Management</option>
                  </select>
                  <button class="btn btn-primary add-btn" data-target="competencesList"><i class="fa-solid fa-plus"></i> Add</button>
                </div>
              </div>
            </div>

            <!-- Step 5: Languages -->
            <div class="step" id="step5">
              <div class="dots"><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div><div class="dot active"></div><div class="dot"></div></div>
              <div class="card">
                <h3><i class="fa-solid fa-language"></i> Language Skills</h3>
                <ul class="criteria-list" id="languageList">
                  <li class="criteria-item">
                    <div class="row">
                      <div class="name">English</div>
                      <select class="rating"><option value="">Rate…</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
                      <div class="acts">
                        <button class="icon-btn dislike"><i class="fa-solid fa-thumbs-down"></i></button>
                        <button class="icon-btn delete"><i class="fa-solid fa-trash"></i></button>
                      </div>
                    </div>
                    <div class="reason"><textarea placeholder="Why is this not suitable?"></textarea></div>
                  </li>
                </ul>
                <div class="addbar">
                  <select id="languageSelect">
                    <option value="">Add new language…</option>
                    <option>Spanish</option><option>French</option><option>Italian</option>
                  </select>
                  <button class="btn btn-primary add-btn" data-target="languageList"><i class="fa-solid fa-plus"></i> Add</button>
                </div>
              </div>
            </div>

            <!-- Step 6: International -->
            <div class="step" id="step6">
              <div class="dots"><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div><div class="dot active"></div></div>
              <div class="card">
                <h3><i class="fa-solid fa-globe"></i> International Experience</h3>
                <ul class="criteria-list" id="internationalList">
                  <li class="criteria-item">
                    <div class="row">
                      <div class="name">Italy</div>
                      <div class="acts">
                        <button class="icon-btn dislike"><i class="fa-solid fa-thumbs-down"></i></button>
                        <button class="icon-btn delete"><i class="fa-solid fa-trash"></i></button>
                      </div>
                    </div>
                    <div class="reason"><textarea placeholder="Why is this not suitable?"></textarea></div>
                  </li>
                </ul>
                <div class="addbar">
                  <select id="internationalSelect">
                    <option value="">Add new country…</option>
                    <option>United Kingdom</option><option>United States</option><option>Japan</option>
                  </select>
                  <button class="btn btn-primary add-btn" data-target="internationalList"><i class="fa-solid fa-plus"></i> Add</button>
                </div>
              </div>
            </div>

            <!-- Step 7: Education -->
            <div class="step" id="step7">
              <div class="dots"><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div><div class="dot done"></div></div>
              <div class="card">
                <h3><i class="fa-solid fa-graduation-cap"></i> Education</h3>
                <ul class="criteria-list" id="educationList">
                  <li class="criteria-item">
                    <div class="row">
                      <div class="name">Master’s degree</div>
                      <div class="acts">
                        <button class="icon-btn dislike"><i class="fa-solid fa-thumbs-down"></i></button>
                        <button class="icon-btn delete"><i class="fa-solid fa-trash"></i></button>
                      </div>
                    </div>
                    <div class="reason"><textarea placeholder="Why is this not suitable?"></textarea></div>
                  </li>
                </ul>
                <div class="addbar">
                  <select id="educationSelect">
                    <option value="">Add new education…</option>
                    <option>PhD</option><option>Associate degree</option>
                  </select>
                  <button class="btn btn-primary add-btn" data-target="educationList"><i class="fa-solid fa-plus"></i> Add</button>
                </div>
              </div>
            </div>
          </div> <!-- /steps column -->
        </div> <!-- /wiz-grid -->
      </div> <!-- /wiz-body -->

      <div class="wiz-nav">
        <button id="btnPrev" class="wiz-btn secondary" disabled><i class="fa-solid fa-arrow-left"></i> Previous</button>
        <div class="muted"><span id="stepCounter">Step 1 of 7</span></div>
        <button id="btnNext" class="wiz-btn primary">Next <i class="fa-solid fa-arrow-right"></i></button>
      </div>
    </section>

    <!-- =================== COMPLETION =================== -->
    <section id="completionSection" class="done hidden" aria-hidden="true">
      <div class="done-body">
        <div class="tick"><i class="fa-solid fa-check"></i></div>
        <h2 style="margin:6px 0 4px">Analysis Complete!</h2>
        <p class="muted">Your CV has been successfully analyzed and evaluated.</p>
        <button id="btnUploadNew" class="upload-new"><i class="fa-solid fa-upload"></i> Upload New CV</button>
      </div>
    </section>
  </main>

  <script>
    (function(){
      // --- Elements
      const sectionUpload = document.getElementById('sectionUpload');
      const fileInput = document.getElementById('fileInput');
      const dropLabel = document.getElementById('dropLabel');
      const uploadSuccess = document.getElementById('uploadSuccess');
      const fileNameEl = document.getElementById('fileName');
      const fileMetaEl = document.getElementById('fileMeta');
      const startWrap = document.getElementById('startWrap');
      const btnStart = document.getElementById('btnStart');

      const pdfViewerHome = document.getElementById('pdfViewerHome');
      const pdfFrameHome = document.getElementById('pdfFrameHome');
      const pdfPanelWizard = document.getElementById('pdfPanelWizard');
      const pdfFrameWizard = document.getElementById('pdfFrameWizard');

      const wizard = document.getElementById('wizardContainer');
      const btnQuit = document.getElementById('btnQuit');
      const btnPrev = document.getElementById('btnPrev');
      const btnNext = document.getElementById('btnNext');
      const stepCounter = document.getElementById('stepCounter');
      const completion = document.getElementById('completionSection');
      const btnUploadNew = document.getElementById('btnUploadNew');

      const steps = Array.from(document.querySelectorAll('.step'));
      const pills = [1,2,3,4,5,6,7].map(i => document.getElementById('pill'+i));

      let currentStep = 1;
      const totalSteps = 7;
      let objectUrl = null; // for PDF iframe

      // --- Helpers
      function show(el){ el.classList.remove('hidden'); el.setAttribute('aria-hidden','false'); }
      function hide(el){ el.classList.add('hidden'); el.setAttribute('aria-hidden','true'); }

      function resetPdf() {
        if (objectUrl) {
          try { URL.revokeObjectURL(objectUrl); } catch(e){}
          objectUrl = null;
        }
        pdfFrameHome.removeAttribute('src');
        pdfFrameWizard.removeAttribute('src');
        hide(pdfViewerHome);
        hide(pdfPanelWizard);
      }

      function resetToHome(){
        // Reset upload
        fileInput.value = '';
        uploadSuccess.classList.remove('show');
        startWrap.classList.add('hidden');

        // Reset PDF previews
        resetPdf();

        // Hide wizard & completion
        hide(wizard); hide(completion);
        // Show upload
        show(sectionUpload);

        // Reset wizard state
        setStep(1, true);
      }

      function validFile(file){
        const ok = ['pdf','doc','docx'];
        const ext = (file.name.split('.').pop() || '').toLowerCase();
        return ok.includes(ext);
      }

      function isPdf(file){
        const ext = (file.name.split('.').pop() || '').toLowerCase();
        return ext === 'pdf' || file.type === 'application/pdf';
      }

      function formatBytes(bytes){
        const mb = (bytes/1024/1024).toFixed(2);
        return `${mb} MB`;
      }

      function handleFile(file){
        if(!validFile(file)){ toast('Please upload a PDF, DOC or DOCX','error'); return; }
        fileNameEl.textContent = file.name;
        fileMetaEl.textContent = `${(file.name.split('.').pop() || '').toUpperCase()} • ${formatBytes(file.size)}`;
        uploadSuccess.classList.add('show');
        startWrap.classList.remove('hidden');
        startWrap.scrollIntoView({behavior:'smooth', block:'center'});

        // Setup preview
        resetPdf();
        if (isPdf(file)) {
          objectUrl = URL.createObjectURL(file);
          // Show in home
          pdfFrameHome.src = objectUrl;
          show(pdfViewerHome);
          // Prepare for wizard too
          pdfFrameWizard.src = objectUrl;
          show(pdfPanelWizard);
        } else {
          // For DOC/DOCX we can't render locally; keep panels hidden and show a note
          hide(pdfViewerHome);
          hide(pdfPanelWizard);
          toast('Preview not available for DOC/DOCX. Convert to PDF to preview.', 'error');
        }
      }

      function toast(msg, type='success'){
        const n = document.createElement('div');
        n.className = 'toast';
        n.style.background = type === 'error' ? '#991b1b' : '#111827';
        n.innerHTML = msg;
        document.body.appendChild(n);
        setTimeout(()=> n.remove(), 2200);
      }

      // --- Upload events
      fileInput.addEventListener('change', e => { if(e.target.files?.length) handleFile(e.target.files[0]); });

      // Drag & drop
      ['dragover','dragenter'].forEach(evt => dropLabel.addEventListener(evt, e => { e.preventDefault(); dropLabel.classList.add('dragover'); }));
      ['dragleave','drop'].forEach(evt => dropLabel.addEventListener(evt, e => { e.preventDefault(); dropLabel.classList.remove('dragover'); }));
      dropLabel.addEventListener('drop', e => {
        const f = e.dataTransfer?.files?.[0];
        if (f) handleFile(f);
      });

      // --- Start analysis
      btnStart.addEventListener('click', () => {
        hide(sectionUpload); // hide upload area
        show(wizard);        // show wizard
        setStep(1, true);    // go to step 1 (loading)
        // Simulate AI processing then move to step 2
        setTimeout(()=> { setStep(2); }, 1600);
      });

      // --- Navigation
      btnPrev.addEventListener('click', () => { if(currentStep>1) setStep(currentStep-1); });
      btnNext.addEventListener('click', () => {
        if(currentStep < totalSteps){ setStep(currentStep+1); }
        else { // complete
          hide(wizard);
          show(completion);
          completion.scrollIntoView({behavior:'smooth', block:'start'});
          toast('Analysis completed successfully');
        }
      });

      // Quit at any time
      btnQuit.addEventListener('click', () => { resetToHome(); });

      // Upload new CV from completion
      btnUploadNew.addEventListener('click', () => { resetToHome(); sectionUpload.scrollIntoView({behavior:'smooth'}); });

      // --- Wizard state
      function setStep(n, force=false){
        if (n<1 || n>totalSteps) return;
        if (!force && n===currentStep) return;
        currentStep = n;

        // Update step views
        steps.forEach((el, idx) => el.classList.toggle('active', idx === currentStep-1));

        // Pills
        pills.forEach((p, idx) => {
          p.classList.remove('active','done');
          if (idx < currentStep-1) p.classList.add('done');
          if (idx === currentStep-1) p.classList.add('active');
        });

        // Dots in each step
        document.querySelectorAll('.step').forEach((stepEl, sIdx) => {
          const dots = stepEl.querySelectorAll('.dot');
          dots.forEach((d, i) => {
            d.classList.toggle('done', i < currentStep-1);
            d.classList.toggle('active', i === currentStep-1);
          });
        });

        // Buttons
        btnPrev.disabled = currentStep === 1;
        if (currentStep === totalSteps) {
          btnNext.innerHTML = '<i class="fa-solid fa-check"></i> Complete';
        } else {
          btnNext.innerHTML = 'Next <i class="fa-solid fa-arrow-right"></i>';
        }

        // Counter
        stepCounter.textContent = `Step ${currentStep} of ${totalSteps}`;
      }

      // --- Criteria interactions (event delegation)
      document.addEventListener('click', (e) => {
        const del = e.target.closest('.delete, .icon-btn.delete');
        const dis = e.target.closest('.dislike, .icon-btn.dislike');
        const add = e.target.closest('.add-btn');

        if (del){
          const item = del.closest('.criteria-item');
          if (item){ item.style.opacity='0'; item.style.transform='translateX(-10px)'; setTimeout(()=> item.remove(), 200); }
        }

        if (dis){
          const item = dis.closest('.criteria-item');
          dis.classList.toggle('active');
          const box = item.querySelector('.reason');
          if (box) box.classList.toggle('show', dis.classList.contains('active'));
        }

        if (add){
          const listId = add.getAttribute('data-target');
          const select = add.previousElementSibling;
          const val = (select && select.value || '').trim();
          if (!val) { toast('Please select a value','error'); return; }
          const list = document.getElementById(listId);
          if (!list) return;

          const needsRating = ['industryList','functionsList','languageList'].includes(listId);
          const li = document.createElement('li');
          li.className = 'criteria-item';
          li.innerHTML = `
            <div class="row">
              <div class="name">${val}</div>
              ${needsRating ? `
                <select class="rating">
                  <option value="">Rate…</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
                </select>` : ''}
              <div class="acts">
                <button class="icon-btn dislike" title="Dislike"><i class="fa-solid fa-thumbs-down"></i></button>
                <button class="icon-btn delete" title="Delete"><i class="fa-solid fa-trash"></i></button>
              </div>
            </div>
            <div class="reason"><textarea placeholder="Why is this not suitable?"></textarea></div>
          `;
          li.style.opacity='0'; li.style.transform='translateY(8px)';
          list.appendChild(li);
          setTimeout(()=>{ li.style.transition='all .25s ease'; li.style.opacity='1'; li.style.transform='none'; }, 20);
          select.value='';
          toast('Added');
        }
      });

      // init
      resetToHome();

      // Revoke objectURL on unload just in case
      window.addEventListener('beforeunload', resetPdf);
    })();
  </script>
</body>
</html>